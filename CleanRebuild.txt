@echo off
set PROJECT_DIR=C:\Users\Joseph\Documents\GitHub\lane_runner_v2\LaneRunnerProject
set UE_DIR=C:\Program Files\Epic Games\UE_5.6

echo === Cleaning generated folders ===
rmdir /s /q "%PROJECT_DIR%\Binaries"
rmdir /s /q "%PROJECT_DIR%\DerivedDataCache"
rmdir /s /q "%PROJECT_DIR%\Intermediate"
rmdir /s /q "%PROJECT_DIR%\Saved"

echo === Regenerating Visual Studio project files (UE5-safe) ===
"%UE_DIR%\Engine\Binaries\DotNET\UnrealBuildTool\UnrealBuildTool.exe" ^
-projectfiles ^
-project="%PROJECT_DIR%\LaneRunnerProject.uproject" ^
-game -engine -progress

echo === Building project (Development Editor) ===
"%UE_DIR%\Engine\Build\BatchFiles\Build.bat" ^
LaneRunnerProjectEditor ^
Win64 ^
Development ^
-project="%PROJECT_DIR%\LaneRunnerProject.uproject" ^
-waitmutex -NoHotReload

echo === DONE ===
pause
